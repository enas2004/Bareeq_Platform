{% if products %}
  {% if error_warning %}
    <div class="alert alert-danger alert-dismissible">
      <i class="fa-solid fa-circle-exclamation"></i> {{ error_warning }}
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
  {% endif %}
  {% if error_stock %}
    <div class="alert alert-danger alert-dismissible">
      <i class="fa-solid fa-circle-exclamation"></i> {{ error_stock }}
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
  {% endif %}
  {% if success %}
    <div class="alert alert-success alert-dismissible">
      <i class="fa-solid fa-circle-check"></i> {{ success }}
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
  {% endif %}
  {% if attention %}
    <div class="alert alert-info">
      <i class="fa-solid fa-circle-info"></i> {{ attention }}
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
  {% endif %}

  {# <h1 class="bareeq-cart-title">
    {{ heading_title }}{% if weight %} <span class="bareeq-cart-weight">({{ weight }})</span>{% endif %}
  </h1> #}

  <div id="output-cart" class="bareeq-cart-table-wrap">
    <div class="table-responsive bareeq-cart-table-responsive">
      <table class="table bareeq-cart-table">
        <thead>
          <tr>
            <th class="text-center bareeq-th-image">{{ column_image }}</th>
            <th class="bareeq-th-name">{{ column_name }}</th>
            <th class="bareeq-th-qty">{{ column_quantity }}</th>
            <th class="text-end bareeq-th-price">{{ column_price }}</th>
            <th class="text-end bareeq-th-total">{{ column_total }}</th>
          </tr>
        </thead>

        <tbody>
          {% for product in products %}
            <tr class="bareeq-row">
              <td class="text-center bareeq-td-image" data-label="{{ column_image }}">
                {% if product.thumb %}
                  <a class="bareeq-thumb" href="{{ product.href }}">
                    <img src="{{ product.thumb }}" alt="{{ product.name }}" title="{{ product.name }}" />
                  </a>
                {% endif %}
              </td>

              <td class="bareeq-td-name text-wrap" data-label="{{ column_name }}">
                <div class="bareeq-name">
                  <a class="bareeq-name-link" href="{{ product.href }}">{{ product.name }}</a>
                  {% if not product.stock %}
                    <span class="bareeq-oos">***</span>
                  {% endif %}
                </div>

                <ul class="bareeq-meta">
                  <li><small>{{ text_model }}: {{ product.model }}</small></li>

                  {% for option in product.option %}
                    <li><small>{{ option.name }}: {{ option.value }}</small></li>
                  {% endfor %}

                  {% if product.subscription %}
                    <li><small>{{ text_subscription }}: {{ product.subscription }}</small></li>
                  {% endif %}

                  {% if product.reward %}
                    <li><small>{{ text_points }}: {{ product.reward }}</small></li>
                  {% endif %}
                </ul>
              </td>

              <td class="bareeq-td-qty" data-label="{{ column_quantity }}">
                <form method="post" data-oc-target="#shopping-cart">
                  <div class="bareeq-qtybox">
                    <input
                      type="text"
                      name="quantity"
                      value="{{ product.quantity }}"
                      class="form-control bareeq-qty-input{% if product.minimum %} is-invalid{% endif %}"
                      inputmode="numeric"
                    />
                    <input type="hidden" name="key" value="{{ product.cart_id }}"/>

                    <div class="bareeq-actions">
                      <button
                        type="submit"
                        formaction="{{ edit }}"
                        data-bs-toggle="tooltip"
                        title="{{ button_update }}"
                        class="btn btn-primary bareeq-btn-icon"
                      >
                        <i class="fa-solid fa-rotate"></i>
                      </button>

                      <a
                        href="{{ product.remove }}"
                        data-bs-toggle="tooltip"
                        title="{{ button_remove }}"
                        class="btn btn-danger bareeq-btn-icon"
                      >
                        <i class="fa-solid fa-circle-xmark"></i>
                      </a>
                    </div>
                  </div>
                </form>

                {% if product.minimum %}
                  <small class="invalid-feedback d-block">{{ product.minimum }}</small>
                {% endif %}
              </td>

              <td class="text-end bareeq-td-price" data-label="{{ column_price }}">
                <x-currency code="{{ currency }}" amount="{{ product.price }}"></x-currency>
              </td>

              <td class="text-end bareeq-td-total" data-label="{{ column_total }}">
                <x-currency code="{{ currency }}" amount="{{ product.total }}"></x-currency>
              </td>
            </tr>
          {% endfor %}
        </tbody>

        <tfoot id="checkout-total" class="bareeq-tfoot">
          {% for total in totals %}
            <tr>
              <td colspan="4" class="text-end bareeq-total-title">
                <strong>{{ total.title }}</strong>
              </td>
              <td class="text-end bareeq-total-value">
                <strong><x-currency code="{{ currency }}" amount="{{ total.value }}"></x-currency></strong>
              </td>
            </tr>
          {% endfor %}
        </tfoot>
      </table>
    </div>
  </div>

  {% if modules %}
    <h2 class="bareeq-next-title">{{ text_next }}</h2>
    <p class="bareeq-next-sub">{{ text_next_choice }}</p>

    {# <div id="accordion" class="accordion bareeq-accordion">
      {% for module in modules %}
        {{ module }}
      {% endfor %}
    </div> #}
  {% endif %}

  <div class="bareeq-cart-footer row">
    <div class="col">
      <a href="{{ continue }}" class="btn btn-light bareeq-btn-soft">{{ button_shopping }}</a>
    </div>
    <div class="col text-end">
      <a href="{{ checkout }}" class="btn btn-primary bareeq-btn-main">{{ button_checkout }}</a>
    </div>
  </div>

{% else %}
  
  <p>{{ text_no_results }}</p>
  <div class="text-end">
    <a href="{{ continue }}" class="btn btn-primary">{{ button_continue }}</a>
  </div>
{% endif %}
